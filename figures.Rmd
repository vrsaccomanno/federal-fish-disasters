---
title: "figures"
author: "Vienna Saccomanno"
date: "1/16/2020"
output:
  pdf_document: default
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(tinytex.verbose = TRUE)
```

## R Markdown

```{r}
library(dplyr)
library(rlang)
#library(tidyverse)
library(readr)
library(viridis)
library(hrbrthemes)
library(ggsci)
library(gridExtra)
library(ggplot2)

rlang:::rlang_is_string
```

###Making allocation bar charts on trends
```{r}
allo_cause <- read.delim("By Cause/Allocation_by_cause.txt")
allo_region<- read.delim("By Region/Allocation_2019USD_1989-2019.txt")

#Changing legend order
levels(allo_cause$Cause)
allo_cause$Cause<- factor(allo_cause$Cause, levels = c("Anthropogenic", "Environmental", "Combination of both"))


#allocation by cause
cause_p0 <- ggplot(allo_cause, aes(fill= Cause, y=Allocation, x=Year))+
  geom_bar(position = "stack", stat= "identity")+
  scale_y_continuous(labels = scales::dollar)+
  scale_x_continuous(breaks=seq(1995,2018,5))+
  scale_fill_uchicago()+
  theme_classic()

cause_p1 <- cause_p0 + labs(x="",
                Y= "Allocation",
                subtitle= "A")
cause_p1


#allocation by region
region_p0 <- ggplot(allo_region, aes(fill= Region, y=Allocation, x=Year))+
  geom_bar(position = "stack", stat= "identity")+
  scale_y_continuous(labels = scales::dollar)+
  scale_x_continuous(breaks=seq(1994,2018,5))+
  scale_fill_jama()+
  theme_classic()

region_p1 <- region_p0 + labs(x="Year",
                Y= "Allocation",
                subtitle= "B",
                caption = "Source: NOAA")
region_p1

grid.arrange(cause_p1, region_p1)

```


###Making frequency and state-year bar charts on trends
```{r}

#By Region
freq_region <- read.delim("By Region/Frequency_1994-2019.txt")
styr_region<- read.delim("By Region/StateYears_1989-2019.txt")

#By cause
freq_cause <- read.delim("By Cause/Frequency_by_cause.txt")
styr_cause<- read.delim("By Cause/State-years_by_cause.txt")


#Changing legend order
levels(freq_cause$Cause)
freq_cause$Cause<- factor(freq_cause$Cause, levels = c("Anthropogenic", "Environmental", "Combination of both"))


#Frequency by cause -B
cause_p3 <- ggplot(freq_cause, aes(fill= Cause, y=Frequency, x=Year))+
  geom_bar(position = "stack", stat= "identity")+
  ylim(0, 10)+
  scale_x_continuous(breaks=seq(1995,2019,5))+
  scale_fill_uchicago()+
  labs(x="Year", Y= "Frequency", subtitle= "B")+
  theme_classic()


#Stateyear by cause - D
cause_p5 <- ggplot(styr_cause, aes(fill= Cause, y=StateYears, x=Year))+
  geom_bar(position = "stack", stat= "identity")+
  ylim(0, 12.0)+
  #scale_y_continuous(breaks=seq(0,10,2.5))+
  scale_x_continuous(breaks=seq(1995,2019,5))+
  scale_fill_uchicago()+
  labs(x="Year", Y= "State-year", subtitle= "D")+
  theme_classic()


#Frequency by Region -A
region_p3 <- ggplot(freq_region, aes(fill= Region, y=Frequency, x=Year))+
  geom_bar(position = "stack", stat= "identity")+
  ylim(0, 10)+
  scale_x_continuous(breaks=seq(1995,2019,5))+
  scale_fill_uchicago()+
  labs(x="Year", Y= "Frequency", subtitle= "A")+
  theme_classic()


#Stateyear by Region - C
region_p5 <- ggplot(styr_region, aes(fill= Region, y=StateYears, x=Year))+
  geom_bar(position = "stack", stat= "identity")+
  ylim(0, 12.0)+
  #scale_y_continuous(breaks=seq(0,10,2.5))+
  scale_x_continuous(breaks=seq(1995,2019,5))+
  scale_fill_uchicago()+
  labs(x="Year", Y= "State-year", subtitle= "C")+
  theme_classic()


grid.arrange(region_p3, cause_p3, region_p5, cause_p5)
```

